{"ast":null,"code":"import axios from \"../helpers/axios\";\nimport store from \"../store\";\nimport { cartConstants, ticketConstants } from \"./constants\";\nexport const getSearchedTicket = data => {\n  return async dispatch => {\n    try {\n      dispatch({\n        type: ticketConstants.GET_SEARCHED_TICKET_REQUEST\n      });\n      const res = await axios.get(\"/ticket/getTicketByLocation\", data);\n      console.log(res);\n\n      if (res.status === 200) {\n        const {\n          tickets\n        } = res.data;\n        dispatch({\n          type: ticketConstants.GET_SEARCHED_TICKET_SUCCESS,\n          payload: {\n            tickets\n          }\n        });\n      } else {\n        dispatch({\n          type: ticketConstants.GET_SEARCHED_TICKET_FAILURE\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\nexport const addToCart = (product, newQty = 1) => {\n  return async dispatch => {\n    const {\n      cart: {\n        cartItems\n      },\n      auth\n    } = store.getState();\n    const qty = cartItems[product._id] ? parseInt(cartItems[product._id].qty + newQty) : 1;\n    cartItems[product._id] = { ...product,\n      qty\n    };\n\n    if (auth.authenticate) {\n      console.log(\"Product qty if auth\", qty);\n      dispatch({\n        type: cartConstants.ADD_TO_CART_REQUEST\n      });\n      const payload = {\n        cartItems: [{\n          product: product._id,\n          quantity: qty\n        }]\n      };\n      console.log(payload);\n      const res = await axios.post(`/user/cart/addtocart`, payload);\n      console.log(res);\n\n      if (res.status === 201) {\n        dispatch(getCartItems());\n      }\n    } else {\n      localStorage.setItem(\"cart\", JSON.stringify(cartItems));\n    } // console.log(\"addToCart::\", cartItems);\n\n\n    dispatch({\n      type: cartConstants.ADD_TO_CART_SUCCESS,\n      payload: {\n        cartItems\n      }\n    });\n  };\n};\nexport const decreaseCart = product => {\n  return async dispatch => {\n    const {\n      cartItems\n    } = store.getState().cart; // console.log(\"action::products\", products);\n\n    const qty = cartItems[product._id] ? parseInt(cartItems[product._id].qty - 1) : 1;\n    cartItems[product._id] = { ...product,\n      qty\n    };\n    localStorage.setItem(\"cart\", JSON.stringify(cartItems));\n    dispatch({\n      type: cartConstants.DECREASE_CART,\n      payload: {\n        cartItems\n      }\n    });\n  };\n};","map":{"version":3,"sources":["/home/mdalif/Desktop/coding/MERN/mern-frontend/src/actions/ticket.action.js"],"names":["axios","store","cartConstants","ticketConstants","getSearchedTicket","data","dispatch","type","GET_SEARCHED_TICKET_REQUEST","res","get","console","log","status","tickets","GET_SEARCHED_TICKET_SUCCESS","payload","GET_SEARCHED_TICKET_FAILURE","error","addToCart","product","newQty","cart","cartItems","auth","getState","qty","_id","parseInt","authenticate","ADD_TO_CART_REQUEST","quantity","post","getCartItems","localStorage","setItem","JSON","stringify","ADD_TO_CART_SUCCESS","decreaseCart","DECREASE_CART"],"mappings":"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","sourcesContent":["import axios from \"../helpers/axios\";\nimport store from \"../store\";\nimport { cartConstants,ticketConstants } from \"./constants\";\n\nexport const getSearchedTicket = (data) => {\n\treturn async (dispatch) => {\n\t\ttry {\n\t\t\tdispatch({ type: ticketConstants.GET_SEARCHED_TICKET_REQUEST });\n\t\t\tconst res = await axios.get(\"/ticket/getTicketByLocation\",data);\n\t\t\tconsole.log(res);\n\t\t\tif (res.status === 200) {\n\t\t\t\tconst { tickets } = res.data;\n\t\t\t\n\t\t\t\t\tdispatch({\n\t\t\t\t\t\ttype: ticketConstants.GET_SEARCHED_TICKET_SUCCESS,\n\t\t\t\t\t\tpayload: { tickets },\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tdispatch({type:ticketConstants.GET_SEARCHED_TICKET_FAILURE})\n\t\t\t\t}\n\t\t\t\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t}\n\t};\n};\n\nexport const addToCart = (product, newQty = 1) => {\n\treturn async (dispatch) => {\n\t\tconst {\n\t\t\tcart: { cartItems },\n\t\t\tauth,\n\t\t} = store.getState();\n\n\t\tconst qty = cartItems[product._id]\n\t\t\t? parseInt(cartItems[product._id].qty + newQty)\n\t\t\t: 1;\n\t\tcartItems[product._id] = {\n\t\t\t...product,\n\t\t\tqty,\n\t\t};\n\n\t\tif (auth.authenticate) {\n\t\t\tconsole.log(\"Product qty if auth\", qty);\n\t\t\tdispatch({ type: cartConstants.ADD_TO_CART_REQUEST });\n\t\t\tconst payload = {\n\t\t\t\tcartItems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tproduct: product._id,\n\t\t\t\t\t\tquantity: qty,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t\tconsole.log(payload);\n\t\t\tconst res = await axios.post(`/user/cart/addtocart`, payload);\n\t\t\tconsole.log(res);\n\t\t\tif (res.status === 201) {\n\t\t\t\tdispatch(getCartItems());\n\t\t\t}\n\t\t} else {\n\t\t\tlocalStorage.setItem(\"cart\", JSON.stringify(cartItems));\n\t\t}\n\n\t\t// console.log(\"addToCart::\", cartItems);\n\n\t\tdispatch({\n\t\t\ttype: cartConstants.ADD_TO_CART_SUCCESS,\n\t\t\tpayload: { cartItems },\n\t\t});\n\t};\n};\n\nexport const decreaseCart = (product) => {\n\treturn async (dispatch) => {\n\t\tconst { cartItems } = store.getState().cart;\n\t\t// console.log(\"action::products\", products);\n\n\t\tconst qty = cartItems[product._id]\n\t\t\t? parseInt(cartItems[product._id].qty - 1)\n\t\t\t: 1;\n\t\tcartItems[product._id] = {\n\t\t\t...product,\n\t\t\tqty,\n\t\t};\n\t\tlocalStorage.setItem(\"cart\", JSON.stringify(cartItems));\n\t\tdispatch({\n\t\t\ttype: cartConstants.DECREASE_CART,\n\t\t\tpayload: {\n\t\t\t\tcartItems,\n\t\t\t},\n\t\t});\n\t};\n};\n\n\n"]},"metadata":{},"sourceType":"module"}