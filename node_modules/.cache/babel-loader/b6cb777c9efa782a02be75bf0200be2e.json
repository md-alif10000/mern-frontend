{"ast":null,"code":"import axios from \"../helpers/axios\";\nimport store from \"../store\";\nimport { cartConstants } from \"./constants\";\n\nconst getCartItems = () => {\n  return async dispatch => {\n    try {\n      dispatch({\n        type: cartConstants.ADD_TO_CART_REQUEST\n      });\n      const res = await axios.get('/user/cart/getCartItems');\n      console.log(res);\n\n      if (res.status === 200) {\n        const {\n          cartItems\n        } = res.data;\n        console.log({\n          getCartItems: cartItems\n        });\n\n        if (cartItems) {\n          dispatch({\n            type: cartConstants.ADD_TO_CART_SUCCESS,\n            payload: {\n              cartItems\n            }\n          });\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\n\nexport const addToCart = (product, newQty = 1) => {\n  return async dispatch => {\n    const {\n      cart: {\n        cartItems\n      },\n      auth\n    } = store.getState(); //console.log('action::products', products);\n    //const product = action.payload.product;\n    //const products = state.products;\n\n    const qty = cartItems[product._id] ? parseInt(cartItems[product._id].qty + newQty) : 1;\n    cartItems[product._id] = { ...product,\n      qty\n    };\n\n    if (auth.authenticate) {\n      const {\n        cart: {\n          cartItems\n        },\n        auth\n      } = store.getState();\n      dispatch({\n        type: cartConstants.ADD_TO_CART_REQUEST\n      });\n      const payload = {\n        // cartItems: Object.keys(cartItems).map((key, index) => {\n        //     return {\n        //         quantity: cartItems[key].qty,\n        //         product: cartItems[key]._id\n        //     }\n        // })\n        cartItems // : [\n        // \t{\n        // \t\tproduct: product._id,\n        // \t\tquantity: qty,\n        // \t},\n        // ],\n\n      };\n      console.log('payload...', payload);\n      const res = await axios.post(`/user/cart/addtocart`, payload);\n      console.log(res);\n\n      if (res.status === 201) {\n        dispatch(getCartItems());\n      }\n    } else {\n      localStorage.setItem(\"cart\", JSON.stringify(cartItems));\n    }\n\n    console.log(\"addToCart::\", cartItems);\n    dispatch({\n      type: cartConstants.ADD_TO_CART_SUCCESS,\n      payload: {\n        cartItems\n      }\n    });\n  };\n};\nexport const decreaseCart = product => {\n  return async dispatch => {\n    const {\n      cartItems\n    } = store.getState().cart; // console.log(\"action::products\", products);\n\n    const qty = cartItems[product._id] ? parseInt(cartItems[product._id].qty - 1) : 1;\n    cartItems[product._id] = { ...product,\n      qty\n    };\n    localStorage.setItem(\"cart\", JSON.stringify(cartItems));\n    dispatch({\n      type: cartConstants.DECREASE_CART,\n      payload: {\n        cartItems\n      }\n    });\n  };\n};\nexport const updateCart = () => {\n  return async dispatch => {\n    const {\n      auth\n    } = store.getState();\n    let cartItems = localStorage.getItem(\"cart\") ? JSON.parse(localStorage.getItem(\"cart\")) : null;\n    console.log(\"upppppppppp\");\n\n    if (auth.authenticate) {\n      localStorage.removeItem(\"cart\"); //dispatch(getCartItems());\n\n      if (cartItems) {\n        const payload = {\n          cartItems: Object.keys(cartItems).map((key, index) => {\n            return {\n              quantity: cartItems[key].qty,\n              product: cartItems[key]._id\n            };\n          })\n        };\n\n        if (Object.keys(cartItems).length > 0) {\n          const res = await axios.post(`/user/cart/addtocart`, payload);\n\n          if (res.status === 201) {\n            dispatch(getCartItems());\n          }\n        }\n      } else {\n        dispatch(getCartItems());\n      }\n    } else {\n      if (cartItems) {\n        dispatch({\n          type: cartConstants.ADD_TO_CART_SUCCESS,\n          payload: {\n            cartItems\n          }\n        });\n      }\n    }\n  };\n};\nexport { getCartItems };","map":{"version":3,"sources":["/home/mdalif/Desktop/coding/Flipkart_Clone/flipkart_clone/src/actions/cart.action.js"],"names":["axios","store","cartConstants","getCartItems","dispatch","type","ADD_TO_CART_REQUEST","res","get","console","log","status","cartItems","data","ADD_TO_CART_SUCCESS","payload","error","addToCart","product","newQty","cart","auth","getState","qty","_id","parseInt","authenticate","post","localStorage","setItem","JSON","stringify","decreaseCart","DECREASE_CART","updateCart","getItem","parse","removeItem","Object","keys","map","key","index","quantity","length"],"mappings":"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","sourcesContent":["import axios from \"../helpers/axios\";\nimport store from \"../store\";\nimport { cartConstants } from \"./constants\";\n\n\n\nconst getCartItems = () => {\n\treturn async (dispatch) => {\n\t  try {\n\t\tdispatch({ type: cartConstants.ADD_TO_CART_REQUEST });\n\t\tconst res = await axios.get('/user/cart/getCartItems');\n\t\tconsole.log(res)\n\t\tif (res.status === 200) {\n\t\t  const { cartItems } = res.data;\n\t\t  console.log({ getCartItems: cartItems });\n\t\t  if (cartItems) {\n\t\t\tdispatch({\n\t\t\t  type: cartConstants.ADD_TO_CART_SUCCESS,\n\t\t\t  payload: { cartItems },\n\t\t\t});\n\t\t  }\n\t\t}\n\t  } catch (error) {\n\t\tconsole.log(error);\n\t  }\n\t};\n  };\n\n\n\n\n\n\n\nexport const addToCart = (product, newQty = 1) => {\n\treturn async (dispatch) => {\n\t\tconst {\n\t\t\tcart: { cartItems },\n\t\t\tauth,\n\t\t} = store.getState();\n\t\t\n\t\t//console.log('action::products', products);\n\t\t//const product = action.payload.product;\n\t\t//const products = state.products;\n\t\tconst qty = cartItems[product._id]\n\t\t\t? parseInt(cartItems[product._id].qty + newQty)\n\t\t\t: 1;\n\t\tcartItems[product._id] = {\n\t\t\t...product,\n\t\t\tqty,\n\t\t};\n\n\t\tif (auth.authenticate) {\n\t\t\t\tconst {\n\t\t\t\t\tcart: { cartItems },\n\t\t\t\t\tauth,\n\t\t\t\t} = store.getState();\n\t\t\tdispatch({ type: cartConstants.ADD_TO_CART_REQUEST });\n\t\t\tconst payload = {\n\t\t\t\t// cartItems: Object.keys(cartItems).map((key, index) => {\n\t\t\t\t//     return {\n\t\t\t\t//         quantity: cartItems[key].qty,\n\t\t\t\t//         product: cartItems[key]._id\n\t\t\t\t//     }\n\t\t\t\t// })\n\t\t\t\tcartItems\n\t\t\t\t// : [\n\t\t\t\t// \t{\n\t\t\t\t// \t\tproduct: product._id,\n\t\t\t\t// \t\tquantity: qty,\n\t\t\t\t// \t},\n\t\t\t\t// ],\n\t\t\t};\n\t\t\tconsole.log('payload...',payload);\n\t\t\tconst res = await axios.post(`/user/cart/addtocart`, payload);\n\t\t\tconsole.log(res);\n\t\t\tif (res.status === 201) {\n\t\t\t\tdispatch(getCartItems());\n\t\t\t}\n\t\t} else {\n\t\t\tlocalStorage.setItem(\"cart\", JSON.stringify(cartItems));\n\t\t}\n\n\t\tconsole.log(\"addToCart::\", cartItems);\n\n\t\tdispatch({\n\t\t\ttype: cartConstants.ADD_TO_CART_SUCCESS,\n\t\t\tpayload: { cartItems },\n\t\t});\n\t};\n};\n\n\nexport const decreaseCart = (product) => {\n\treturn async (dispatch) => {\n\t\tconst { cartItems } = store.getState().cart;\n\t\t// console.log(\"action::products\", products);\n\n\t\tconst qty = cartItems[product._id]\n\t\t\t? parseInt(cartItems[product._id].qty - 1)\n\t\t\t: 1;\n\t\t\tcartItems[product._id] = {\n\t\t\t...product,\n\t\t\tqty,\n\t\t};\n\t\tlocalStorage.setItem(\"cart\", JSON.stringify(cartItems));\n\t\tdispatch({\n\t\t\ttype: cartConstants.DECREASE_CART,\n\t\t\tpayload: {\n\t\t\t\tcartItems\n\t\t\t},\n\t\t});\n\t};\n};\n\n\nexport const updateCart = () => {\n\treturn async (dispatch) => {\n\t  const { auth } = store.getState();\n\t  let cartItems = localStorage.getItem(\"cart\")\n\t\t? JSON.parse(localStorage.getItem(\"cart\"))\n\t\t: null;\n  \n\t  console.log(\"upppppppppp\");\n  \n\t  if (auth.authenticate) {\n\t\tlocalStorage.removeItem(\"cart\");\n\t\t//dispatch(getCartItems());\n\t\tif (cartItems) {\n\t\t  const payload = {\n\t\t\tcartItems: Object.keys(cartItems).map((key, index) => {\n\t\t\t  return {\n\t\t\t\tquantity: cartItems[key].qty,\n\t\t\t\tproduct: cartItems[key]._id,\n\t\t\t  };\n\t\t\t}),\n\t\t  };\n\t\t  if (Object.keys(cartItems).length > 0) {\n\t\t\tconst res = await axios.post(`/user/cart/addtocart`, payload);\n\t\t\tif (res.status === 201) {\n\t\t\t  dispatch(getCartItems());\n\t\t\t}\n\t\t  }\n\t\t} else {\n\t\t  dispatch(getCartItems());\n\t\t}\n\t  } else {\n\t\tif (cartItems) {\n\t\t  dispatch({\n\t\t\ttype: cartConstants.ADD_TO_CART_SUCCESS,\n\t\t\tpayload: { cartItems },\n\t\t  });\n\t\t}\n\t  }\n\t};\n  };\n\n\n\n\nexport {getCartItems}"]},"metadata":{},"sourceType":"module"}