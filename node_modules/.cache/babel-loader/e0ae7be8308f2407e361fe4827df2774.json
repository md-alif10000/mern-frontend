{"ast":null,"code":"import _objectSpread from\"/home/mdalif/Desktop/coding/MERN/mern-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/mdalif/Desktop/coding/MERN/mern-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mdalif/Desktop/coding/MERN/mern-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"../helpers/axios\";import store from\"../store\";import{cartConstants}from\"./constants\";var getCartItems=function getCartItems(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res,cartItems;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:cartConstants.ADD_TO_CART_REQUEST});_context.next=4;return axios.get('/user/cart/getCartItems');case 4:res=_context.sent;console.log(res);if(res.status===200){cartItems=res.data.cartItems;console.log({getCartItems:cartItems});if(cartItems){dispatch({type:cartConstants.ADD_TO_CART_SUCCESS,payload:{cartItems:cartItems}});}}_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var addToCart=function addToCart(product){var newQty=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var _store$getState,cartItems,auth,qty,payload,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_store$getState=store.getState(),cartItems=_store$getState.cart.cartItems,auth=_store$getState.auth;qty=cartItems[product._id]?parseInt(cartItems[product._id].qty+newQty):1;cartItems[product._id]=_objectSpread(_objectSpread({},product),{},{qty:qty});if(!auth.authenticate){_context2.next=15;break;}console.log(\"Product qty if auth\",qty);dispatch({type:cartConstants.ADD_TO_CART_REQUEST});payload={cartItems:[{product:product._id,quantity:qty}]};console.log(payload);_context2.next=10;return axios.post(\"/user/cart/addtocart\",payload);case 10:res=_context2.sent;console.log(res);if(res.status===201){dispatch(getCartItems());}_context2.next=16;break;case 15:localStorage.setItem(\"cart\",JSON.stringify(cartItems));case 16:// console.log(\"addToCart::\", cartItems);\ndispatch({type:cartConstants.ADD_TO_CART_SUCCESS,payload:{cartItems:cartItems}});case 17:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var decreaseCart=function decreaseCart(product){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var cartItems,qty;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:cartItems=store.getState().cart.cartItems;// console.log(\"action::products\", products);\nqty=cartItems[product._id]?parseInt(cartItems[product._id].qty-1):1;cartItems[product._id]=_objectSpread(_objectSpread({},product),{},{qty:qty});localStorage.setItem(\"cart\",JSON.stringify(cartItems));dispatch({type:cartConstants.DECREASE_CART,payload:{cartItems:cartItems}});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var updateCart=function updateCart(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var _store$getState2,auth,cartItems,payload,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_store$getState2=store.getState(),auth=_store$getState2.auth;cartItems=localStorage.getItem(\"cart\")?JSON.parse(localStorage.getItem(\"cart\")):null;if(!auth.authenticate){_context4.next=16;break;}localStorage.removeItem(\"cart\");//dispatch(getCartItems());\nif(!cartItems){_context4.next=13;break;}payload={cartItems:Object.keys(cartItems).map(function(key,index){return{quantity:cartItems[key].qty,product:cartItems[key]._id};})};if(!(Object.keys(cartItems).length>0)){_context4.next=11;break;}_context4.next=9;return axios.post(\"/user/cart/addtocart\",payload);case 9:res=_context4.sent;if(res.status===201){dispatch(getCartItems());}case 11:_context4.next=14;break;case 13:dispatch(getCartItems());case 14:_context4.next=17;break;case 16:if(cartItems){dispatch({type:cartConstants.ADD_TO_CART_SUCCESS,payload:{cartItems:cartItems}});}case 17:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export{getCartItems};","map":{"version":3,"sources":["/home/mdalif/Desktop/coding/MERN/mern-frontend/src/actions/cart.action.js"],"names":["axios","store","cartConstants","getCartItems","dispatch","type","ADD_TO_CART_REQUEST","get","res","console","log","status","cartItems","data","ADD_TO_CART_SUCCESS","payload","addToCart","product","newQty","getState","cart","auth","qty","_id","parseInt","authenticate","quantity","post","localStorage","setItem","JSON","stringify","decreaseCart","DECREASE_CART","updateCart","getItem","parse","removeItem","Object","keys","map","key","index","length"],"mappings":"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","sourcesContent":["import axios from \"../helpers/axios\";\nimport store from \"../store\";\nimport { cartConstants } from \"./constants\";\n\n\n\nconst getCartItems = () => {\n\treturn async (dispatch) => {\n\t  try {\n\t\tdispatch({ type: cartConstants.ADD_TO_CART_REQUEST });\n\t\tconst res = await axios.get('/user/cart/getCartItems');\n\t\tconsole.log(res)\n\t\tif (res.status === 200) {\n\t\t  const { cartItems } = res.data;\n\t\t  console.log({ getCartItems: cartItems });\n\t\t  if (cartItems) {\n\t\t\tdispatch({\n\t\t\t  type: cartConstants.ADD_TO_CART_SUCCESS,\n\t\t\t  payload: { cartItems },\n\t\t\t});\n\t\t  }\n\t\t}\n\t  } catch (error) {\n\t\tconsole.log(error);\n\t  }\n\t};\n  };\n\n\n\n\n\n\n\nexport const addToCart = (product, newQty = 1) => {\n\treturn async (dispatch) => {\n\t\tconst {\n\t\t\tcart: { cartItems },\n\t\t\tauth,\n\t\t} = store.getState();\n\t\n\t\tconst qty = cartItems[product._id]\n\t\t\t? parseInt(cartItems[product._id].qty + newQty)\n\t\t\t: 1;\n\t\tcartItems[product._id] = {\n\t\t\t...product,\n\t\t\tqty,\n\t\t};\n\n\t\t\n\n\t\tif (auth.authenticate) {\n\t\t\t\t\tconsole.log(\"Product qty if auth\", qty);\n\t\t\tdispatch({ type: cartConstants.ADD_TO_CART_REQUEST });\n\t\t\tconst payload = {\n\t\t\t\n\t\t\t\tcartItems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tproduct: product._id,\n\t\t\t\t\t\tquantity: qty,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t\tconsole.log(payload);\n\t\t\tconst res = await axios.post(`/user/cart/addtocart`, payload);\n\t\t\tconsole.log(res);\n\t\t\tif (res.status === 201) {\n\t\t\t\tdispatch(getCartItems());\n\t\t\t}\n\t\t} else {\n\t\t\tlocalStorage.setItem(\"cart\", JSON.stringify(cartItems));\n\t\t}\n\n\t\t// console.log(\"addToCart::\", cartItems);\n\n\t\tdispatch({\n\t\t\ttype: cartConstants.ADD_TO_CART_SUCCESS,\n\t\t\tpayload: { cartItems },\n\t\t});\n\t};\n};\n\n\nexport const decreaseCart = (product) => {\n\treturn async (dispatch) => {\n\t\tconst { cartItems } = store.getState().cart;\n\t\t// console.log(\"action::products\", products);\n\n\t\tconst qty = cartItems[product._id]\n\t\t\t? parseInt(cartItems[product._id].qty - 1)\n\t\t\t: 1;\n\t\t\tcartItems[product._id] = {\n\t\t\t...product,\n\t\t\tqty,\n\t\t};\n\t\tlocalStorage.setItem(\"cart\", JSON.stringify(cartItems));\n\t\tdispatch({\n\t\t\ttype: cartConstants.DECREASE_CART,\n\t\t\tpayload: {\n\t\t\t\tcartItems\n\t\t\t},\n\t\t});\n\t};\n};\n\n\nexport const updateCart = () => {\n\treturn async (dispatch) => {\n\t  const { auth } = store.getState();\n\t  let cartItems = localStorage.getItem(\"cart\")\n\t\t? JSON.parse(localStorage.getItem(\"cart\"))\n\t\t: null;\n  \n\n  \n\t  if (auth.authenticate) {\n\t\tlocalStorage.removeItem(\"cart\");\n\t\t//dispatch(getCartItems());\n\t\tif (cartItems) {\n\t\t  const payload = {\n\t\t\tcartItems: Object.keys(cartItems).map((key, index) => {\n\t\t\t  return {\n\t\t\t\tquantity: cartItems[key].qty,\n\t\t\t\tproduct: cartItems[key]._id,\n\t\t\t  };\n\t\t\t}),\n\t\t  };\n\t\t  if (Object.keys(cartItems).length > 0) {\n\t\t\tconst res = await axios.post(`/user/cart/addtocart`, payload);\n\t\t\tif (res.status === 201) {\n\t\t\t  dispatch(getCartItems());\n\t\t\t}\n\t\t  }\n\t\t} else {\n\t\t  dispatch(getCartItems());\n\t\t}\n\t  } else {\n\t\tif (cartItems) {\n\t\t  dispatch({\n\t\t\ttype: cartConstants.ADD_TO_CART_SUCCESS,\n\t\t\tpayload: { cartItems },\n\t\t  });\n\t\t}\n\t  }\n\t};\n  };\n\n\n\n\nexport {getCartItems}"]},"metadata":{},"sourceType":"module"}